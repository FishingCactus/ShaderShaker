<project name="Shader Shaker" basedir=".">

	<property name="shader_shaker" location="..\bin\release\shader_shaker.exe" />
	
	<condition property="executable_exists">
		<resourceexists>
            <file file="..\bin\release\shader_shaker.exe" />
        </resourceexists>
	</condition>
	
	<target name="generate_reference" if="executable_exists">
		<mkdir dir="..\reference" />
		
		<apply executable="${shader_shaker}" dest="..\reference">
			<mapper type="glob" from="*.fx" to="*.ast"/>
			<arg value="-o"/>
			<targetfile />
			<srcfile />
			
			<fileset dir="..\test">
				<include name="*.fx" />
			</fileset>
		</apply>
	</target>
	
	<target name="check"  if="executable_exists">
		<apply executable="${shader_shaker}" dest="..\reference" force="true">
			<mapper type="glob" from="*.fx" to="*.ast"/>
			<arg value="-check"/>
			<targetfile />
			
			<fileset dir="..\test">
				<include name="*.fx" />
			</fileset>
			<srcfile />
		</apply>
	</target>
</project>